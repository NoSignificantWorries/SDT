Задание 1. Линейная регрессия (LinReg) и дисперсионный анализ (ANOVA)
[1] Выбрать один из датасетов из перечня:
- Iris
- Wine Quality
- Palmer Archipelago (Antarctica) penguin
- Любой другой датасет, в котором есть три класса и четыре количественных
(недискретных) признака.
[2] Вывести в табличной форме статистику по датасету, включая
- Размерность всего датасета
- Количество признаков
- Количество целевых классов и объектов в каждом из классов
- Процент объектов с неопределенными признаками
- Иные ключевые характеристики датасета
Выбрать три класса и четыре количественных (недискретных) признака.
Сформировать на их основе «отфильтрованный» датасет для дальнейшего анализа, удалив
из датасета все объекты, для которых не определены значения хотя бы одного из
выбранных четырех количественных признаков.
[3] Выполнить визуализацию датасета по всем парам выбранных количественных
переменных, обозначая:
- в графиках с разными парами переменных объекты из разных классов различными по
форме и цвету точками,
- в графиках с одной и той же парой переменных – гистограммы с достаточным числом
разбиений (обычно – не менее 20), либо плотности распределения переменной по оси
признака.
[4] В табличном варианте оценить степень сопряженности пар признак-признак на всем
датасете, используя коэффициенты корреляции Пирсона и Спирмана, с p-критериями для
коэффициентов. В табличном варианте также оценить степень сопряженности пар признакпризнак в каждом отдельном классе, используя коэффициенты корреляции Пирсона и
Спирмана, с p-критериями для коэффициентов. Таблицы корреляций также отобразить как
тепловые карты.
[5] Отдельно повторно выполнить пункт [3]; на каждом из графиков для каждого из классов
отобразить линию линейной регрессии с соответствующими прогнозными интервалами
регрессий (95% predictive bands).
[6] Повторить пункт [5], но с доверительными интервалами регрессий (95% confidence
bands).
[7] Вывести формулы каждой линейной регрессии вместе со значениями критерия R2,
критерия Вальда (F-критерий, его степени свободы и соответствующий p-критерий),
критерия LR (хи-квадрат-критерий, степени свободы и соответствующий p-критерий),
критерия score (хи-квадрат-критерий, степени свободы и соответствующий p-критерий).
[8] Выбрать любой количественный признак и выполнить дисперсионный анализ (ANOVA):
- Рассчитать F-критерий, его степени свободы и соответствующий ему p-критерий для
всех классов одновременно;
- Рассчитать F-критерий, степени свободы и соответствующий ему p-критерий для каждой
пары сравниваемых классов;
- Визуализировать выбранный количественный признак для каждого из классов в виде
raincloud plot with jittering, рядом с каждым классом в виде boxplot отобразить медианы,
межквартильные размахи (IQR) и 95% доверительные интервалы.
[9] Повторить пункт [8] для каждого отдельного из остальных трех признаков.

Ззадание 2. LDA – линейный дискриминантный анализ.
[1] Используя функцию make_blobs с любым random_state, сгенерировать датасет df1, в
котором есть три класса с размером каждого класса 1000 объектов и 16 количественных
(недискретных) признаков. Распределения двух из трех классов должны значительно
перекрывать друг друга, тогда как третий класс должен быть на расстоянии от первых двух
классов.
# Не забываем повторять шаги задания 1:
- корреляции
- ключевые характеристики датасета
- визуализация на всех парах переменных
[2] На основе созданного в пункте [1] датасета df1 сгенерировать отдельные
дополнительные датасеты (df2, df5, df10…), в которых объекты одного класса (который
имеет пересечение с другим) повторены 2 раза, 5 раз, 10 раз, 20 раз, 50 раз, 100 раз, 1000
раз, 10k раз, а количество объектов в остальных классах осталось неизменно.
[3] Выбрать пару классов (включая класс с повторенными объектами) и пару
количественных признаков. Используя метод LDA, для каждого из сформированных
датасетов df1, df2, df5, df10, df20, df50, df100, df1000, df10k графически построить решающую
функцию алгоритма, разграниченные решающей функцией зоны и отдельные объекты
классов; отдельно численно вывести время построения каждого решения.
# Визуализацию данного пункта лучше реализовать в паре с пунктом [5].
[4] Для датасетов df1, df2, df5, df10, df20, df50, df100, df1000 из пункта [3] восстановить в
таблицу координаты следующих точек:
- центры масс каждого класса;
- общий центр масс выбранных классов;
- центр отрезка, соединяющего центры масс выбранных классов.
Для датасетов отдельно на графиках с решающей функцией LDA вывести положения
центров масс и соединяющий центры масс классов отрезок с его центральной точкой.
[5] Выбрать целевой класс для решений из пункта [3].
Для каждого из решений из пункта [3], оценить качество работы полученных на основе LDA
классификаторов, используя ROC кривые и восстановив на графике каждой ROC кривой
соответствующие решению LDA 95% доверительные полосы (Confidence bands 95%) этой
ROC кривой бутстрепом (n=1000 или больше). Для каждой кривой численно также
отобразить метрику AUROС (AUC для ROC кривой классификации Sensitivity-Specificity и ее
доверительные интервалы CI95).
# Все полученные графики возможно расположить в две колонки: левая колонка –
визуализация пространства и решений LDA, правая – графики с ROC кривой и
доверительными полосами.
[6] Повторить пункт [5] для PR кривых и отобразить численно метрику AUPRC (AUC для PR).
[7] В пункте [5] выбрать другой целевой класс и повторить визуализации ROC кривых.
[8] Для датасета df10 на основе 3-fold, 5-fold, 10-fold, 20-fold, 50-fold, 100-fold кроссвалидации построить кривые AUROC и AUPRC c 95% доверительными полосами (CI95).
# Вместо CI95 можно взять CI90, CI80 или другой квантиль доверительной полосы.
[9] Для датасета df1 построить решения LDA на двух, четырех, восьми и шестнадцати
признаках. Для каждого решения восстановить по пункту [5] ROC кривые с доверительными
полосами 95%.
[10*] Повторить пункты [3]+[5] для алгоритма QDA (квадратичный дискриминатный анализ).
https://stackoverflow.com/questions/55541254/precision-recall-curve-with-n-fold-cross-validation-showing-standard-deviation
https://stackoverflow.com/questions/29656550/how-to-plot-pr-curve-over-10-folds-of-cross-validation-in-scikit-learn


